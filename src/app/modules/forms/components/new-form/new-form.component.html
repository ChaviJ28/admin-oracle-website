<div class="new-form-page">
  <div class="container">
    <div style="margin-bottom: 25px;">
      <h4 class="dialog-title">UoM Oracle Club Form Creator System - New Form</h4>
    </div>

    <div class="new-form-details mb-3">
      <mat-card [formGroup]="DetailsForm">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Form Title:</mat-label>
          <input matInput type="text" formControlName="formTitle" value="{{this.formDetails.title}}">
        </mat-form-field>
        <div class="row">
          <div class="col-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Custom URL:</mat-label>
              <input matInput formControlName="formCustomUrl" value="{{this.formDetails.custom_url}}">
            </mat-form-field>
          </div>
          <div class="col-3">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Form End Time:</mat-label>
              <input matInput type="date" formControlName="formEndDate" value="{{this.formDetails.end_date}}">
            </mat-form-field>
          </div>
          <div class="col-3">
            <!-- <mat-form-field appearance="outline" class="w-100">
              <mat-label>banner:</mat-label>
              <input matInput type="text" formControlName="formBanner">
            </mat-form-field> -->
            <input type="file"  accept="image/png, image/gif, image/jpeg" class="file-input" (change)="onFileSelected($event)" #fileUpload >
            <div class="file-upload">
              <button mat-mini-fab color="primary" class="upload-btn" (click)="fileUpload.click()">
                <mat-icon>attach_file</mat-icon>
              </button>
              {{fileName || "No file uploaded yet."}}
            </div>
          </div>
        </div>
        <mat-label>Description:</mat-label>
        <angular-editor class="w-100" formControlName="formDescription" [config]="editorConfig"></angular-editor>
      </mat-card>
    </div>

    <div class="row">
      <div class="col-3 form-field-option">
        <select #nFormFieldOptions (change)="addFormField(nFormFieldOptions.value)">
          <option disabled selected value="">Select Input Field</option>
          <option *ngFor="let opt of formfieldOptions; let i = index" value="{{opt.value}}">{{opt.text}}</option>
        </select>
      </div>


      <div class="col-3 new-form-submit-btn">
        <button mat-raised-button color="primary" (click)="submitNewForm()">
          Submit
        </button>
      </div>
    </div>

    <div class="row new-block new-form">

      <form [formGroup]="RegForm" (ngSubmit)="submitNewForm()">
        <div formArrayName="Regf">


          <div class="mt-3" id="contentInside" *ngFor="let reg of RF.controls; let i=index">
            <div [formGroupName]="i">
              <span>{{RF.get(i.toString())?.value.type}} Field</span>

              <div *ngIf="RF.get(i.toString())?.value.type === 'short_text'">
                <mat-expansion-panel>
                  <mat-expansion-panel-header [collapsedHeight]="'120px'" [expandedHeight]="'120px'">
                    <mat-form-field appearance="outline" color="warn" class="w-95">
                      <mat-label>{{this.RF.get(i.toString())?.value.label}}</mat-label>
                      <input matInput placeholder="{{this.RF.get(i.toString())?.value.placeholder}}">
                    </mat-form-field>

                  </mat-expansion-panel-header>
                  <div class="row">
                    <div class="col-6">
                      <div>
                        <mat-form-field appearance="outline" color="accent" class="w-50">
                          <mat-label>Label Name</mat-label>
                          <input matInput placeholder="e.g First Name" formControlName="label">
                        </mat-form-field>
                      </div>

                      <div>
                        <mat-form-field appearance="outline" color="accent" class="w-50">
                          <mat-label>Placeholder</mat-label>
                          <input matInput placeholder="eg.San" formControlName="placeholder">
                        </mat-form-field>
                      </div>

                    </div>
                    <div class="col-3">
                      <mat-label class="me-2">Required:</mat-label>
                      <mat-slide-toggle>
                      </mat-slide-toggle>

                    </div>
                    <div class="col-3 text-end">
                      <a class="me-2 ms-2" (click)="remove(i)" mat-mini-fab color="primary">
                        <!-- <a class="me-2 ms-2" mat-mini-fab color="primary"> -->
                        <mat-icon>delete</mat-icon>
                      </a>
                    </div>
                  </div>
                </mat-expansion-panel>
              </div>

              <div *ngIf="RF.get(i.toString())?.value.type === 'email'">
                <mat-expansion-panel>
                  <mat-expansion-panel-header [collapsedHeight]="'120px'" [expandedHeight]="'120px'">
                    <mat-form-field appearance="outline" color="warn" class="w-95">
                      <mat-label>{{this.RF.get(i.toString())?.value.label}}</mat-label>
                      <input matInput placeholder="{{this.RF.get(i.toString())?.value.placeholder}}">
                    </mat-form-field>

                  </mat-expansion-panel-header>
                  <div class="row">
                    <div class="col-6">
                      <div>
                        <mat-form-field appearance="outline" color="accent" class="w-50">
                          <mat-label>Label Name</mat-label>
                          <input matInput placeholder="e.g First Name" formControlName="label">
                        </mat-form-field>
                      </div>

                      <div>
                        <mat-form-field appearance="outline" color="accent" class="w-50">
                          <mat-label>Placeholder</mat-label>
                          <input matInput placeholder="eg.San" formControlName="placeholder">
                        </mat-form-field>
                      </div>

                    </div>
                    <div class="col-3">
                      <mat-label class="me-2">Required:</mat-label>
                      <mat-slide-toggle>
                      </mat-slide-toggle>

                    </div>
                    <div class="col-3 text-end">
                      <a class="me-2 ms-2" (click)="remove(i)" mat-mini-fab color="primary">
                        <mat-icon>delete</mat-icon>
                      </a>
                    </div>
                  </div>
                </mat-expansion-panel>
              </div>

              <div *ngIf="RF.get(i.toString())?.value.type === 'long_text'">
                <mat-expansion-panel>
                  <mat-expansion-panel-header [collapsedHeight]="'120px'" [expandedHeight]="'120px'">
                    <mat-form-field appearance="outline" color="warn" class="w-95">
                      <mat-label>{{this.RF.get(i.toString())?.value.label}}</mat-label>
                      <textarea matInput placeholder="{{this.RF.get(i.toString())?.value.placeholder}}"></textarea>
                    </mat-form-field>

                  </mat-expansion-panel-header>
                  <div class="row">
                    <div class="col-6">
                      <div>
                        <mat-form-field appearance="outline" color="accent" class="w-50">
                          <mat-label>Label Name</mat-label>
                          <input matInput placeholder="e.g First Name" formControlName="label">
                        </mat-form-field>
                      </div>

                      <div>
                        <mat-form-field appearance="outline" color="accent" class="w-50">
                          <mat-label>Placeholder</mat-label>
                          <input matInput placeholder="eg.San" formControlName="placeholder">
                        </mat-form-field>
                      </div>

                    </div>
                    <div class="col-3">
                      <mat-label class="me-2">Required:</mat-label>
                      <mat-slide-toggle>
                      </mat-slide-toggle>

                    </div>
                    <div class="col-3 text-end">
                      <a class="me-2 ms-2" (click)="remove(i)" mat-mini-fab color="primary">
                        <mat-icon>delete</mat-icon>
                      </a>
                    </div>
                  </div>
                </mat-expansion-panel>
              </div>

              <div *ngIf="RF.get(i.toString())?.value.type === 'radio'">
                <mat-expansion-panel>
                  <mat-expansion-panel-header [collapsedHeight]="((TF(i).length * 20) + 50).toString() + 'px'" [expandedHeight]="((TF(i).length * 25) + 50).toString() + 'px'">
                    <label>{{this.RF.get(i.toString())?.value.label}}</label>
                    <mat-radio-group color="warn" fxLayout="column" fxLayoutAlign="end">
                      <mat-radio-button *ngFor="let x of TF(i).controls; let opt=index;">{{TF(i).controls[opt].value}}</mat-radio-button>
                    </mat-radio-group>

                  </mat-expansion-panel-header>
                  <div class="row">
                    <div class="col-6">
                      <mat-form-field appearance="outline" color="accent" class="w-50">
                        <mat-label>Label Name</mat-label>
                        <input matInput placeholder="e.g age" formControlName="label">
                      </mat-form-field>
                      <div formArrayName="option">

                        <div *ngFor="let x of TF(i).controls; let opt=index;">
                          <mat-form-field appearance="outline" color="accent" class="w-50">
                            <mat-label>Option</mat-label>
                            <input matInput placeholder="e.g name of option" formControlName={{opt}}>
                          </mat-form-field>
                          <button mat-icon-button class="me-2 ms-2" (click)="removeOption(i,opt)" color="warn">
                            <mat-icon>delete</mat-icon>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-3">
                      <mat-label class="me-2">Required:</mat-label>
                      <mat-slide-toggle>
                      </mat-slide-toggle>

                    </div>
                    <div class="col-3 text-end">
                      <a (click)="addOption(i)" mat-mini-fab color="accent">
                        <mat-icon>add</mat-icon>
                      </a>
                      <a class="me-2 ms-2" (click)="remove(i)" mat-mini-fab color="primary">
                        <mat-icon>delete</mat-icon>
                      </a>

                    </div>
                  </div>
                </mat-expansion-panel>
              </div>

              <div *ngIf="RF.get(i.toString())?.value.type === 'checkbox'">
                <mat-expansion-panel>
                  <mat-expansion-panel-header [collapsedHeight]="((TF(i).length * 45) + 70).toString() + 'px'" [expandedHeight]="((TF(i).length * 45) + 70).toString() + 'px'">
                    <label>{{this.RF.get(i.toString())?.value.label}}</label>
                    <section class="w-95">
                      <mat-checkbox [disabled]="true" *ngFor="let x of TF(i).controls; let opt=index;">{{TF(i).controls[opt].value}}</mat-checkbox>
                    </section>

                  </mat-expansion-panel-header>
                  <div class="row">
                    <div class="col-6">
                      <mat-form-field appearance="outline" color="accent" class="w-50">
                        <mat-label>Label Name</mat-label>
                        <input matInput placeholder="e.g age" formControlName="label">
                      </mat-form-field>
                      <div formArrayName="option">

                        <div *ngFor="let x of TF(i).controls; let opt=index;">
                          <mat-form-field appearance="outline" color="accent" class="w-50">
                            <mat-label>Option</mat-label>
                            <input matInput placeholder="e.g name of option" formControlName={{opt}}>
                          </mat-form-field>
                          <button mat-icon-button class="me-2 ms-2" (click)="removeOption(i,opt)" color="warn">
                            <mat-icon>delete</mat-icon>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-3">
                      <mat-label class="me-2">Required:</mat-label>
                      <mat-slide-toggle>
                      </mat-slide-toggle>

                    </div>
                    <div class="col-3 text-end">
                      <a (click)="addOption(i)" mat-mini-fab color="accent">
                        <mat-icon>add</mat-icon>
                      </a>
                      <a class="me-2 ms-2" (click)="remove(i)" mat-mini-fab color="primary">
                        <mat-icon>delete</mat-icon>
                      </a>

                    </div>
                  </div>
                </mat-expansion-panel>
              </div>


              <div *ngIf="RF.get(i.toString())?.value.type === 'select'">
                <mat-expansion-panel>
                  <mat-expansion-panel-header [collapsedHeight]="'150px'" [expandedHeight]="'150px'">
                    <mat-form-field appearance="outline" color="warn" class="w-95">
                      <mat-label>{{this.RF.get(i.toString())?.value.label}}</mat-label>
                      <mat-select matNativeControl [formControl]="selectedOption">
                        <mat-option *ngFor="let x of TF(i).controls; let opt=index;">{{TF(i).controls[opt].value}}</mat-option>
                      </mat-select>
                    </mat-form-field>

                  </mat-expansion-panel-header>

                  <div class="row">
                    <div class="col-6">
                      <mat-form-field appearance="outline" color="accent" class="w-50">
                        <mat-label>Label Name</mat-label>
                        <input matInput placeholder="e.g age" formControlName="label">
                      </mat-form-field>
                      <div formArrayName="option">

                        <div *ngFor="let x of TF(i).controls; let opt=index;">
                          <mat-form-field appearance="outline" color="accent" class="w-50">
                            <mat-label>Option</mat-label>
                            <input matInput placeholder="e.g name of option" formControlName={{opt}}>
                          </mat-form-field>
                          <button mat-icon-button class="me-2 ms-2" (click)="removeOption(i,opt)" color="warn">
                            <mat-icon>delete</mat-icon>
                          </button>
                        </div>

                      </div>
                    </div>
                    <div class="col-3">
                      <mat-label>Required:</mat-label>
                      <mat-slide-toggle formControlName="req">
                      </mat-slide-toggle>
                    </div>
                    <div class="col-3 text-end">
                      <a (click)="addOption(i)" mat-mini-fab color="accent">
                        <mat-icon>add</mat-icon>
                      </a>
                      <a class="me-2 ms-2" (click)="remove(i)" mat-mini-fab color="primary">
                        <mat-icon>delete</mat-icon>
                      </a>

                    </div>
                  </div>

                </mat-expansion-panel>
              </div>


            </div>
          </div>
        </div>
      </form>

    </div>

    <!-- <div style=" display: flex; justify-content: end;">
      <button mat-raised-button color="primary" (click)="newForm()">
        Submit
      </button>
    </div> -->

  </div>
</div>